{"version":3,"file":"sales_save.js","sourceRoot":"","sources":["../../ui/sales_save.ts"],"names":[],"mappings":"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","sourcesContent":["////////////////// Message 전달 ///////////////////////////////////\r\n\r\nclass MessageBroker{\r\n    table : Map<any, any>;\r\n    constructor(){\r\n        this.table = new Map();\r\n    }\r\n\r\n    publish(responseId, data){\r\n        if(this.table.has(responseId)){\r\n            const subscriber = this.table.get(responseId);\r\n            subscriber(data);\r\n        }\r\n    }\r\n    subscribe(key, subscriber){\r\n        this.table.set(key,subscriber);\r\n    }\r\n}\r\n\r\nconst Broker = new MessageBroker();\r\n\r\nwindow.addEventListener(\"message\",function(event){\r\n    if(event.data.responseId != undefined){\r\n        Broker.publish(event.data.responseId, event.data.user);\r\n    }\r\n});\r\n\r\nconst ecount = {\r\n    popup : function(url:string, name:string, option:string){\r\n        return new Promise(function(resolve, reject){\r\n            const responseId:string = Date.now().toString();\r\n\r\n            Broker.subscribe(responseId, resolve);\r\n            window.open(`${url}?responseId=${responseId}`, name, option);\r\n        });\r\n    }\r\n};\r\n\r\n\r\n//////////////////////////////// Decorator Popup///////////////////////////////////////\r\n\r\nclass ActionBroker{\r\n    table : Map<string, Function>;\r\n    constructor(){\r\n        this.table = new Map();\r\n    }\r\n\r\n    produce(id:string){\r\n        if(this.table.has(id)){\r\n            const func = this.table.get(id);\r\n            func();\r\n        }\r\n    }\r\n    subscribe(key:string, executefunc:Function){\r\n        this.table.set(key, executefunc);\r\n    }\r\n}\r\n\r\nconst actionBroker = new ActionBroker();\r\n\r\n/////////// 버튼 클릭으로 팝업창 열기 /////////////\r\n\r\nwindow.addEventListener(\"click\", (e:MouseEvent)=>{\r\n    if(actionBroker.table.has(`/click/${(e.target as HTMLButtonElement).id}`)){\r\n        actionBroker.produce(`/click/${(e.target as HTMLButtonElement).id}`);\r\n    }\r\n})\r\n\r\nconst ListenClickEvent = function Listen(path: string): any {\r\n    return function (target: any, propertyKey: string, descriptor: PropertyDescriptor) {\r\n\r\n        actionBroker.subscribe(`/click/${path}`, function(){\r\n            const subscriber = new target();\r\n            subscriber.execute(ecount);\r\n        })\r\n    };\r\n};\r\n\r\n////////////// F8로 팝업창 열기 ////////////////\r\n\r\nwindow.addEventListener(\"keydown\", (e)=>{\r\n    if(actionBroker.table.has(`/keydown/${e.key}`)){\r\n        actionBroker.produce(`/keydown/${e.key}`);\r\n    }\r\n})\r\n\r\nconst ListenKeyEvent = function Listen(path: string[]): any {\r\n    return function (target: any, propertyKey: string, descriptor: PropertyDescriptor) {\r\n\r\n        actionBroker.subscribe(`/keydown/${path[0]}`, function(){\r\n            const subscriber = new target();\r\n            subscriber.execute(ecount);\r\n        })\r\n    };\r\n};\r\n\r\n// decorator\r\n@ListenClickEvent(\"newbtn\")\r\n@ListenKeyEvent([\"F8\"])\r\nclass SalesSave{\r\n    async execute(viewHandler){\r\n        const message = await viewHandler.popup(\"/register\",\"newbtnpopup\",\"width:400, height:400\");\r\n        const welcome = message.id+\"님 환영합니다.\\n회사코드 : \" + message.comcode + \"\\n권한 : \"+message.permission+\"\\n마지막 로그인 시각 : \"+message.logdate;\r\n        alert(welcome);\r\n    }\r\n}\r\n\r\n// 버튼들...\r\nwindow.onload = function(){\r\n    let listbtn:HTMLElement = document.getElementById(\"listbtn\");\r\n    if(listbtn!=null){\r\n        listbtn.onclick = function(){\r\n            console.log(\"dkdkdk\");\r\n            var child = window.open('/list', \"listbtnpopup\",\"width:400, height:400\");\r\n        }\r\n    }\r\n    \r\n    let alertbtn:HTMLElement = document.getElementById(\"alertbtn\");\r\n    if(alertbtn!=null){\r\n        alertbtn.onclick = function(){\r\n            alert(\"Read권한이 필요합니다.\");\r\n        }\r\n    }\r\n}"]}